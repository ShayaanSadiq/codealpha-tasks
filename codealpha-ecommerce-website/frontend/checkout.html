<!doctype html><html><head><meta charset="utf-8"><title>Checkout</title><link rel="stylesheet" href="assets/main.css"></head><body>
<div class="header"><div class="container"><a href="index.html">Home</a></div></div>
<div class="container">
  <h1>Checkout</h1>
  <form id="checkoutForm">
    <div><textarea id="address" placeholder="Shipping address" required style="width:100%;height:80px"></textarea></div>
    <button type="submit">Place Order</button>
  </form>
</div>
<script src="assets/main.js"></script>
<script>
  document.getElementById('checkoutForm').onsubmit = async (e)=>{
    e.preventDefault();
    const token = localStorage.getItem('token');
    if(!token) return alert('Login required');
    const items = JSON.parse(localStorage.getItem('cart')||'[]');
    if(items.length===0) return alert('Cart is empty');
    const address = document.getElementById('address').value;
    const res = await fetch(API_BASE + '/orders', {
      method:'POST',
      headers: Object.assign({'Content-Type':'application/json'}, { 'Authorization': 'Bearer '+token }),
      body: JSON.stringify({ items, address })
    });
    const data = await res.json();
    if(res.ok){
      localStorage.removeItem('cart');
      alert('Order placed. Order id: ' + data._id);
      window.location = 'index.html';
    } else {
      alert(data.message || 'Order failed')
    }
  }
</script>
</body></html>
